\documentclass{article}


\usepackage{meta}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{epsfig}

\setcounter{page}{1}
\sloppy


\title{Finite Difference Time--Domain Modelling of Metamaterials: GPU Implementation of Cylindrical Cloak} % Please input your paper Title

\name{Attique Dawood} % Please input your name if single author. 

\address{
Department of Electrical Engineering, \\
National University of Computer and Emerging Sciences (FAST), Islamabad, Pakistan \\
E-mail: {\tt attique.dawood@nu.edu.pk}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% If multiple authors (but the same affiliation),                      %%
%% uncomment and edit the lines shown below.                            %%
%% Note that each line must be emphasized {\bf \large } by itself.      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\makeatletter
%\def\name#1{\gdef\@name{#1\\}}
%\makeatother
%\name{{\bf \large  Firstname1 Lastname1, Firstname2 Lastname2, Firstname3 Lastname3,}\\
%      {\bf \large  Firstname4 Lastname4, Firstname5 Lastname5, Firstname6 Lastname6,}\\
%      {\bf \large  and Firstname7 Lastname7}}
%%%%%%%%%%%%%%% End of required multiple authors changes %%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% If multiple affiliations, uncomment and edit the lines shown below.  %%
%% Note that each line must be emphasized {\bf \large } by itself.      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\makeatletter
%\def\name#1{\gdef\@name{#1\\}}
%\makeatother
%\name{{\bf \large  Firstname1 Lastname1$^1$, Firstname2 Lastname2$^2$, Firstname3 Lastname3$^{1,3}$,}\\
%      {\bf \large  Firstname4 Lastname4$^3$, Firstname5 Lastname5$^{3*}$, and Firstname6 Lastname6}$^{1,2,4}$}
%\address{
%$^1$School of Energy and Power Engineering, Heat Transfer University, Xi'an, China \\
%$^2$Institute of Power Engineering, Computational Science Research Center, Jeju, Korea \\
%$^3$Department of Mechanical Engineering, University of Heat Transfer and Fluid Flow, Kyoto, Japan \\
%$^4$Department of Aeronautics and Astronautics, National Fluid Flow University, Tainan, Taiwan \\
%*corresponding author, E-mail: {\tt author@xx.yyy.zzz}
%}
%%%%%%%%%%%%% End of required multiple affiliations changes %%%%%%%%%%%%%%

%
\begin{document}
\maketitle

%
\begin{abstract}
Finite difference time--domain (FDTD) technique can be used to model metamaterials by treating them as dispersive material. Drude or Lorentz model can be incorporated into the standard FDTD algorithm for modelling negative permittivity and permeability. FDTD algorithm is readily parallelisable and can take advantage of GPU acceleration to achieve speed--ups of 5x--50x depending on hardware setup. Metamaterial scattering problems are implemented using dispersive FDTD technique on GPU resulting in performance gain of 10x--15x compared to conventional CPU implementation.
\end{abstract}

%
\section{Introduction}

Standard FDTD algorithm cannot cater for negative values of permittivity or permeability. This is because of the Courant stability criterion. As soon as the permeability or permittivity becomes less than unity the algorithm will not be stable. A metamaterial object can be modelled as a dispersive substance using either the Lorentz or Drude dispersive models. These models can yield negative values of permittivity (or permeability) for certain frequency ranges~\cite{NumericalFDTD-Sibel}. Using these dispersive models, FDTD update equations are modified and permittivity and permeabilities are replaced with terms dependent on frequency of operation.

Two problems are chosen for GPU implementation. First is the electromagnetic wave scattering by a slab with negative permittivity and permeability; also known as DNG (double negative) medium. Second problem is the simulation of cylindrical cloak. An incident Gaussian pulse on DNG slab will undergo dispersion resulting in different frequency components being separated. Refractive index and transmission coefficient are calculated numerically to ascertain the validity of implementation. The cylindrical cloak was first proposed and tested by Pendry et. al. \cite{PendryShurig-MicrowaveCloak}. The first FDTD implementation was by Zhao et. al \cite{Radial-Zhao} and implemented on Comsol, a commercial electromagnetic simulation software. Simulations are implemented on Matlab, C++ and GPU. Performance comparison reveals a 10--15 times increase in performance with GPU implementations. Performance gain is greater for larger problem sizes and greater simulation times.

\section{Drude Dispersion Model}

In ideal conditions the permittivity (and permeability) of a material remain constant for any frequency and throughout the structure of that material. Speed of electromagnetic waves in such a medium remain constant if frequency changes. Additionally, there is no loss in energy as the waves pass through the medium.

In reality, such a material does not exist. Speed of EM waves varies with frequency of operation. Also, there is a loss associated with the material. A material is dispersive\index{dispersive material} if its permittivity or permeability is dependent on frequency~\cite[Ch. 10]{JBSchneiderUFDTD}.

The relative permittivity in Drude model\index{Drude model $\epsilon_r(\omega)$} is given by
\begin{equation}
\centering
\hat{\epsilon_r}(\omega)=\epsilon_\infty-\dfrac{\omega^2_p}{\omega^2-j\gamma\omega}.
\label{er-Drude}
\end{equation}
Where, $\omega_p$ is plasma frequency and $\gamma$ is collision frequency. Setting $\gamma=0$ and $\epsilon_\infty=1$, relative permittivity comes out to be negative for $\omega/\omega_p > 1$ (figure~\ref{DrudeModel_er}). Thus, Drude model can be effectively used to model metamaterials\index{metamaterial} with permittivity or permeability less than one by incorporating it into FDTD update equations.
\begin{figure}[t!]
\centering
\includegraphics[scale=0.55, trim=4cm 8.5cm 4cm 8.5cm, clip]{FigCh03_DrudeModel_er.pdf}
\caption{$\epsilon_r$ plotted against $\omega/\omega_p$ for $\epsilon_\infty=1$ and $\gamma=0$}
\label{DrudeModel_er}
\end{figure}

\section{FDTD Update Equations}

Faraday's Law\index{Faraday's Law} and Ampere's Law\index{Ampere's Law} in differential form are given by
\begin{equation}
\centering
\nabla \times \textbf{E} = - \dfrac{\partial \textbf{B}}{\partial t},
\label{Faraday's Law}
\end{equation}
\begin{equation}
\centering
\nabla \times \textbf{H} = \dfrac{\partial \textbf{D}}{\partial t}.
\label{Ampere's Law}
\end{equation}
From \cite{Yee1966}, the update equations for a wave propagating in $z$ direction are given by
\begin{equation}
\begin{split}
H^{n+\frac{1}{2}}_y \left[k+\frac{1}{2}\right]&=H^{n-\frac{1}{2}}_y \left[k+\frac{1}{2}\right]\\ &+
\dfrac{\Delta t}{\mu \Delta x} \left( E^{n}_x \left[k\right] - E^{n}_x \left[k+1\right] \right),
\end{split}
\label{Hy-1D-Simple-FDTD-Driver}
\end{equation}
\begin{equation}
\begin{split}
E^{n+1}_x \left[k\right]&=E^{n}_x \left[k\right]\\&+ \dfrac{\Delta t}{\epsilon \Delta x} \left( H^{n+\frac{1}{2}}_y \left[k-\frac{1}{2}\right] - H^{n+\frac{1}{2}}_y \left[k+\frac{1}{2}\right] \right).
\end{split}
\label{Ex-1D-Simple-FDTD-Driver}
\end{equation}
In the conventional FDTD algorithm future magnetic field components are first computed from past electric field components (eq. \ref{Hy-1D-Simple-FDTD-Driver}). Using the updated magnetic field components, future electric field components are then calculated (eq. \ref{Ex-1D-Simple-FDTD-Driver}) and the simulation proceeds in a leap--frog manner \cite{Yee1966}.

\section{FDTD Update Equations Based on Drude Model}

Electric flux density and electric field are related by
\begin{equation}
\centering
\textbf{D} = \epsilon \textbf{E}.
\label{D-epsilon-E}
\end{equation}
Where $\epsilon = \epsilon_r\epsilon_0$ and $\epsilon_r$ for Drude model is given by equation \ref{er-Drude}. Substituting Drude model $\epsilon_r$, equation \ref{D-epsilon-E} can be written as
\begin{equation}
\centering
\omega^2\textbf{D}-\gamma(j\omega)\textbf{D} = \epsilon_\infty\omega^2\textbf{E}-\omega^2_p\textbf{E}-\epsilon_\infty \gamma(j\omega)\textbf{E}.
\label{D-epsilonomega-E-frequency-domain}
\end{equation}
Following the treatment of \cite{Radial-Zhao} and \cite{JBSchneiderUFDTD}, frequency domain quantities can be converted to time--domain using the relationships $j\omega \rightarrow \partial/\partial t$ and $\omega^2 \rightarrow - \partial^2/\partial t^2$. Moreover, fields multiplying with $\omega^2_p$ are averaged in time. Second--order difference scheme is used, both for single and double derivatives to keep all the terms in accordance with the second--order nature of whole expression. This will result in easier implementation. The final form is given by
\begin{equation}
\begin{split}
E^{n+1}_x&=a_e\left(D^{n+1}_x-2D^n_x+D^{n-1}_x\right)\\&+b_e\left(D^{n+1}_x-D^{n-1}_x\right)
+c_e\left(2E^n_x-E^{n-1}_x\right)\\&+d_e\left(2E^n_x+E^{n-1}_x\right)+e_e E^{n-1}_x.
\end{split}
\label{2nd-order-D-E-final-form}
\end{equation}
This is also known as the auxiliary update equation for electric field where $a_e$--$e_e$ are scalars given by
\begin{equation}
\begin{split}
\nonumber & a_e=4/g,~b_e=\gamma\left(2\Delta t\right)/g,~c_e=4\epsilon_0\epsilon_\infty/g,\\
\nonumber & d_e=-\epsilon_0\omega^2_{p}\left(\Delta t\right)^2/g,~e_e=\epsilon_0\epsilon_\infty \gamma_e\left(2\Delta t\right)/g,\\
\nonumber & g=4\epsilon_0\epsilon_\infty+\epsilon_0\omega^2_{p}\left(\Delta t\right)^2+\epsilon_0\epsilon_\infty \gamma \left(2\Delta t\right)
\end{split}
\label{1D-Drude-E-scalars}
\end{equation}
A similar procedure can be carried out to obtain auxiliary update equation for magnetic field.
\begin{equation}
\begin{split}
H^{n+1}_y&=a_m\left(B^{n+1}_y-2B^n_y+B^{n-1}_y\right)\\&+b_m\left(B^{n+1}_y-B^{n-1}_y\right)
+c_m\left(2H^n_y-H^{n-1}_y\right)\\&+d_m\left(2H^n_y+H^{n-1}_y\right)+e_m H^{n-1}_y.
\end{split}
\label{2nd-order-B-H-final-form}
\end{equation}
For a wave propagating in $z$ direction, FDTD update equations\index{FDTD!update equations} are
\begin{equation}
B^{n+1}_y(k)=B^n_y(k)+\dfrac{\Delta t}{\Delta z}\left(E^n_x(k)-E^n_x(k+1)\right)
\label{1D-B-Update-Equation}
\end{equation}
and
\begin{equation}
D^{n+1}_x(k)=D^n_x(k)+\dfrac{\Delta t}{\Delta z}\left(H^{n+1}_y(k-1)-H^{n+1}_y(k)\right).
\label{1D-D-Update-Equation}
\end{equation}
Equations \ref{1D-B-Update-Equation} and \ref{1D-D-Update-Equation} drive the FDTD algorithm which give future values of $By$ and $Dx$ from past fields. Equations \ref{2nd-order-B-H-final-form} and \ref{2nd-order-D-E-final-form} are auxiliary equations which give future fields $H_y$ and $E_x$ at $n+1$.
\begin{itemize}
\setlength{\itemsep}{-1mm}
\item Paper length is maximum ten pages ({\bf A4} format)
\item Two columns are used except for the title part and possibly for large figures that need a full page width.
\item Margins of at least 15 mm (left/right), 25mm (top/bottom, except headers/footers).
\item Column width is 80 mm.
\item Spacing between columns is 10 mm.
\item Text height (without headers) is maximum 245 mm.
\item Check indentations and spacings by comparing to this example file (in pdf).
\item Title of the paper must be included and same with already submitted one-page abstract.
\item Name of author(s) must be included
\item Affiliation(s) of author(s) must be included
\item Title and author's name must be in larger font and in boldface
\item The abstract file should be converted into pdf format before its uploaded on the submission form
\item Maximum size of the attachment is 5 MB.
\end{itemize}

If you have any questions regarding paper submission please contact {\tt \small meta12@metaconferences.org}. 

\subsubsection{Headings}

Section headings are centered in boldface with the first word capitalized and the rest of the heading in lower case. 
Sub-headings appear like major headings, except they start at the left margin in the column.
Sub-sub-headings appear like sub-headings, except they are in italics and not boldface. 
See the examples given in this  file. 
No more than 3 levels of headings should be used.

\subsection{Text font}

Times or Times Roman font is used for the main text. 
Recommended font size is 10 points which is also the minimum allowed size. 
Other font types may be used if needed for special purposes. 
It is very important that while making the final pdf file, you EMBED ALL USED FONTS!

\subsection{Figures}

All figures must be centered on the column (or page, if the figure spans both columns).
Figure captions should follow each figure and have the format given in  Fig.~\ref{fig:sin}.
Figures which span two columns ({\em i.e.} occupy full page width) should be placed at the top or bottom of the page.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[t!]
%\centerline{\epsfig{figure=sample_figure,width=80mm}}
\caption{This is the figure caption. Color figures are acceptable.}
\label{fig:sin}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Tables}

An example of a table is shown as Table~\ref{table1}. 
Somewhat different styles are allowed according to the type and purpose of the table. 
The caption text must be above the table.

\begin{table}[tbh]
\caption{\label{table1} This is an example of a table.}
\vspace{2mm}
\centerline{
\begin{tabular}{ccc}
\hline
format & size [mm$^2$] & aspect ratio\\
\hline
A4     & $210 \times 297$ & 1.414 \\
JIS B5 & $182 \times 257$ & 1.414 \\
Legal  & $216 \times 356$ & 1.647 \\
Letter & $216 \times 279$ & 1.294 \\
\hline
\end{tabular}}

\end{table}

\subsection{Equations}

Equations should be placed on separate lines and numbered. 
Examples of equations are given below.
\begin{equation}
q=-\lambda \left( \frac{\partial T}{\partial n} \right),
\label{eq1}
\end{equation}
where $\lambda$ is the thermal conductivity.
Equation~(\ref{eq1}) is the differential form of Fourier's Law of thermal conduction.

\subsection{References}

References should be numbered in order of appearance, for example \cite{Zhang10}, \cite{Patankar80}, and \cite{Kays90,Kawa09}. 

\subsection{Submitted files}
Authors are requested to submit PDF files of their manuscripts. 
The PDF file should comply with the following requirements: 
(a) there must be no PASSWORD protection on the PDF file at all; 
(b) all fonts must be embedded; 
and (c) the file must be text searchable (do CTRL-F and try to find a common word such as 'the'). 
The proceedings editors will contact authors of non-complying files to obtain a replacement.

\section{Discussion}

xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx

\section{Conclusions}

xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx

\begin{acknowledgement}
Acknowledgements belong here.
\end{acknowledgement}

\nocite{*}
\bibliographystyle{IEEEtran}
\bibliography{FDTDMETARef}
%\begin{thebibliography}{10}
%%%---
%\bibitem[1]{Zhang10} 
%A.-B. Zhang, C.-D. Kim, E. Yamada, F.G. Smith, 
%The numerical investigation on the turbulent heat transfer, 
%{\em Int. J. Heat Mass Transfer} 12: 345--365, 2010.
%%%---
%\bibitem[2]{Patankar80} 
%S.V. Patankar, 
%{\em Numerical Heat Transfer and Fluid Flow}, 
%Hemisphere Publishers, New York, 1980.
%%%---
%\bibitem[3]{Kays90} 
%W.M. Kays, M.E. Crawford, 
%{\em Heat transfer}, 
%Wiley, New York, pp.256-258, 1990.
%%%---
%\bibitem[4]{Kawa09} 
%Y. Kawaguchi, T. Tsukahara, M. Motozawa, 
%Experimental and numerical investigations of turbulent drag reduction phenomena by additives,
%{\em Proc. aes09},
%Jeju, Korea, pp. 23--32, 2009.
%%%---
%\end{thebibliography}
\end{document}
